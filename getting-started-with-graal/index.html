<!doctype html><html lang=en>
<head>
<title>
Getting started with Graal ::
Henry Stanley
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="GraalVM promises to be &amp;ldquo;one VM to rule them all&amp;rdquo; – a way to &amp;ldquo;run code faster anywhere&amp;rdquo;.
The way it does this is using language interpreters written in a framework called Truffle:
 Truffle is a framework for implementing languages using nothing more than a simple abstract syntax tree interpreter.
 These interpreters turn your code into an AST which can be run on the GraalVM. This gives you:">
<meta name=keywords content>
<meta name=robots content="noodp">
<link rel=canonical href=https://henrystanley.com/getting-started-with-graal/>
<link rel=stylesheet href=https://henrystanley.com/assets/style.css>
<link rel=stylesheet href=https://henrystanley.com/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://henrystanley.com/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://henrystanley.com/img/favicon.png>
<link href=https://henrystanley.com/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://henrystanley.com/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://henrystanley.com/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://henrystanley.com/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://henrystanley.com/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://henrystanley.com/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Getting started with Graal">
<meta name=twitter:description content="GraalVM promises to be &ldquo;one VM to rule them all&rdquo; – a way to &ldquo;run code faster anywhere&rdquo;.
The way it does this is using language interpreters written in a framework called Truffle:
 Truffle is a framework for implementing languages using nothing more than a simple abstract syntax tree interpreter.
 These interpreters turn your code into an AST which can be run on the GraalVM. This gives you:">
<meta property="og:title" content="Getting started with Graal">
<meta property="og:description" content="GraalVM promises to be &ldquo;one VM to rule them all&rdquo; – a way to &ldquo;run code faster anywhere&rdquo;.
The way it does this is using language interpreters written in a framework called Truffle:
 Truffle is a framework for implementing languages using nothing more than a simple abstract syntax tree interpreter.
 These interpreters turn your code into an AST which can be run on the GraalVM. This gives you:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://henrystanley.com/getting-started-with-graal/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2018-07-30T13:08:37-04:00">
<meta property="article:modified_time" content="2018-07-30T13:08:37-04:00"><meta property="og:site_name" content="Henry Stanley">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Henry Stanley</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/post>Archive</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/post>Archive</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>Getting started with Graal</h1>
<div class=post-meta>
<span class=post-date>
2018-07-30
</span>
<span class=post-read-time>— 3 min read</span>
</div>
<div class=post-content>
<p>GraalVM promises to be <a href=https://www.semanticscholar.org/paper/One-VM-to-rule-them-all-W%C3%BCrthinger-Wimmer/53e2b31ad6fea91655ecbe64fe66968b934d0160>&ldquo;one VM to rule them all&rdquo;</a> – a way to &ldquo;run code faster anywhere&rdquo;.</p>
<p>The way it does this is using language interpreters written in a framework called <a href=https://blog.plan99.net/graal-truffle-134d8f28fb69>Truffle</a>:</p>
<blockquote>
<p>Truffle is a framework for implementing languages using nothing more than a simple abstract syntax tree interpreter.</p>
</blockquote>
<p>These interpreters turn your code into an AST which can be run on the GraalVM. This gives you:</p>
<ul>
<li><strong>super fast performance</strong> – e.g. a fourfold increase in speed over Ruby&rsquo;s VM; similar performance to V8 for JavaScript.</li>
<li><strong>JIT compilation and debugging for free</strong> – use Chrome DevTools to debug running code.</li>
<li><strong>interoperability with other Truffle languages</strong> – because multiple languages can target the same VM, you can call code in one language from another with no performance penalty when crossing the language barrier.</li>
</ul>
<p><a href=https://blog.plan99.net/graal-truffle-134d8f28fb69>This article</a> is an amazing technical introduction to the platform. Below, I&rsquo;ll walk you through getting GraalVM installed and running on your machine.</p>
<h2 id=mac-quickstart>Mac quickstart</h2>
<p>The community edition of Graal only runs on Linux, so if you&rsquo;re using a Mac, you&rsquo;ll need to emulate! Here&rsquo;s how I did it.</p>
<ol>
<li>
<p>Download the latest release of <a href=https://github.com/oracle/graal/releases>Graal</a>.</p>
</li>
<li>
<p>Install Docker, either by <a href=https://download.docker.com/mac/static/stable/x86_64/>downloading it</a> or using Homebrew (<code>brew install docker</code>).</p>
</li>
<li>
<p><code>cd</code> into the Graal download directory and start a Docker container as follows:</p>
</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>$ docker run -i -t -v<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>pwd<span style=color:#e6db74>`</span>:/graal ubuntu /bin/bash
</code></pre></div><p>This will bind-mount your current directory to <code>/graal</code> inside the container. When you&rsquo;re in, you can run <code>cd /graal</code> and use the binaries in there directly.</p>
<h2 id=installing-language-packs>Installing language packs</h2>
<p>GraalVM ships with a JVM and its own versions of <code>node</code> and <code>npm</code>, but out of the box you won&rsquo;t be able to run Ruby, Python, or R.</p>
<p>If you&rsquo;re like me, the first thing you want to do is play around with Ruby on GraalVM. To do this, you need to install TruffleRuby. GraalVM comes with its own package management tool, <code>gu</code>, which you can invoke from inside the container:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>root# /graal/bin/gu install ruby
Downloading: Component catalog
Processing component archive: Component ruby
Downloading: Component ruby
Installing new component: TruffleRuby (org.graalvm.ruby, version 1.0.0-rc4)
</code></pre></div><h2 id=using-the-debugger>Using the debugger</h2>
<p>Graal comes with an awesome debugger that lets you step through your code in Chrome DevTools. To do this, you need to allow connections between your container and the host machine.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>$ docker run -i -t -v<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>pwd<span style=color:#e6db74>`</span>:/graal <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -p 9229:9229/tcp ubuntu /bin/bash
</code></pre></div><p>That <code>-p</code> flag opens a port on <code>9229</code> on both the container and the host. When you run a Graal command and invoke the debugger, you need to tell it to use that port, and to bind to 0.0.0.0 (as by default it binds to 127.0.0.1 which refuses incoming connections from outside the container):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>root# /graal/bin/ruby --inspect=&#34;0.0.0.0:9229&#34; mycode.rb
Debugger listening on port 9229.
To start debugging, open the following URL in Chrome:
    chrome-devtools://devtools/bundled/js_app.html?ws=0.0.0.0:9229/ffffffff84647ae2-ffffffa709c7325d
</code></pre></div><p>Graal will print out a URL that you can copy and paste into Chrome which will drop you into a debugger session.</p>
<p><img src=/images/graal-ruby-debug.png alt></p>
<h2 id=what-next>What next?</h2>
<p>Once you&rsquo;re up and running, check out Chris Seaton&rsquo;s excellent <em><a href=https://chrisseaton.com/truffleruby/tenthings/>Top 10 Things To Do With GraalVM</a></em> for more cool things to try out.</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://henrystanley.com/a-buildpack-for-graalvm/>
<span class=button__icon>←</span>
<span class=button__text>A Buildpack for GraalVM</span>
</a>
</span>
<span class="button next">
<a href=https://henrystanley.com/multi-file-wordcount-an-exercise-in-concurrent-ruby/>
<span class=button__text>Multi-file wordcount – an exercise in concurrent Ruby</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Henry Stanley</span>
<span class=logo__cursor></span>
</a>
<div class=copyright>
<span>© 2021 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span>
</div>
</div>
</footer>
<script src=https://henrystanley.com/assets/main.js></script>
<script src=https://henrystanley.com/assets/prism.js></script>
</div>
</body>
</html>